{
  "Bloom filter can process special characters in document name": {
    "describeName": "Existence Filters:",
    "itName": "Bloom filter can process special characters in document name",
    "tags": [
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/ÀÒ∑",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/À∑Ò",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/ÀÒ∑",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/À∑Ò",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "watchFilter": {
          "bloomFilter": {
            "bits": {
              "bitmap": "IIAAIIAIIAAIIAIIAA==",
              "padding": 4
            },
            "hashCount": 10
          },
          "keys": [
            "collection/ÀÒ∑"
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeLimboDocs": [
            "collection/À∑Ò"
          ],
          "activeTargets": {
            "1": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/À∑Ò"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/À∑Ò"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      }
    ]
  },
  "Bloom filter fills in default values for undefined padding and hashCount": {
    "describeName": "Existence Filters:",
    "itName": "Bloom filter fills in default values for undefined padding and hashCount",
    "tags": [
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/a",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/b",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 2
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/a",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/b",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 2
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "watchFilter": {
          "bloomFilter": {
            "bits": {
              "bitmap": "AhAAApAAAIAEBIAABA=="
            }
          },
          "keys": [
            "collection/a"
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeExistenceFilterMismatch"
            }
          }
        }
      }
    ]
  },
  "Bloom filter is handled at global snapshot": {
    "describeName": "Existence Filters:",
    "itName": "Bloom filter is handled at global snapshot",
    "tags": [
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/a",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/b",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 2
              },
              "version": 2000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/a",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/b",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 2
                },
                "version": 2000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "watchFilter": {
          "bloomFilter": {
            "bits": {
              "bitmap": "AhAAApAAAIAEBIAABA==",
              "padding": 4
            },
            "hashCount": 10
          },
          "keys": [
            "collection/a"
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/c",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 3
              },
              "version": 3000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/c",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 3
                },
                "version": 3000
              }
            ],
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeLimboDocs": [
            "collection/b"
          ],
          "activeTargets": {
            "1": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/b"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/b"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      }
    ]
  },
  "Bloom filter limbo resolution is denied": {
    "describeName": "Existence Filters:",
    "itName": "Bloom filter limbo resolution is denied",
    "tags": [
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/a",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/b",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/a",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/b",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "watchFilter": {
          "bloomFilter": {
            "bits": {
              "bitmap": "AhAAApAAAIAEBIAABA==",
              "padding": 4
            },
            "hashCount": 10
          },
          "keys": [
            "collection/a"
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeLimboDocs": [
            "collection/b"
          ],
          "activeTargets": {
            "1": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/b"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/b"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchRemove": {
          "cause": {
            "code": 7
          },
          "targetIds": [
            1
          ]
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            },
            "removed": [
              {
                "createTime": 0,
                "key": "collection/b",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              }
            ]
          }
        ],
        "expectedState": {
          "activeLimboDocs": [
          ],
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      }
    ]
  },
  "Bloom filter with large size works as expected": {
    "describeName": "Existence Filters:",
    "itName": "Bloom filter with large size works as expected",
    "tags": [
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/doc0",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc1",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc2",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc3",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc4",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc5",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc6",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc7",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc8",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc9",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc10",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc11",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc12",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc13",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc14",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc15",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc16",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc17",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc18",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc19",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc20",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc21",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc22",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc23",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc24",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc25",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc26",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc27",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc28",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc29",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc30",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc31",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc32",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc33",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc34",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc35",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc36",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc37",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc38",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc39",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc40",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc41",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc42",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc43",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc44",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc45",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc46",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc47",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc48",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc49",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc50",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc51",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc52",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc53",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc54",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc55",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc56",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc57",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc58",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc59",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc60",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc61",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc62",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc63",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc64",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc65",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc66",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc67",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc68",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc69",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc70",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc71",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc72",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc73",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc74",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc75",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc76",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc77",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc78",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc79",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc80",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc81",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc82",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc83",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc84",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc85",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc86",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc87",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc88",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc89",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc90",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc91",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc92",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc93",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc94",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc95",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc96",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc97",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc98",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/doc99",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/doc0",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc1",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc2",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc3",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc4",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc5",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc6",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc7",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc8",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc9",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc10",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc11",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc12",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc13",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc14",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc15",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc16",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc17",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc18",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc19",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc20",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc21",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc22",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc23",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc24",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc25",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc26",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc27",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc28",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc29",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc30",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc31",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc32",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc33",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc34",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc35",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc36",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc37",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc38",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc39",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc40",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc41",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc42",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc43",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc44",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc45",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc46",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc47",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc48",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc49",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc50",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc51",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc52",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc53",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc54",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc55",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc56",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc57",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc58",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc59",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc60",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc61",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc62",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc63",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc64",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc65",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc66",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc67",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc68",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc69",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc70",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc71",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc72",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc73",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc74",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc75",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc76",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc77",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc78",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc79",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc80",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc81",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc82",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc83",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc84",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc85",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc86",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc87",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc88",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc89",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc90",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc91",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc92",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc93",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc94",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc95",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc96",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc97",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc98",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/doc99",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "watchFilter": {
          "bloomFilter": {
            "bits": {
              "bitmap": "+9oMQXUptl274DOaET8sfebQ4aCu0Roiddbja3z8TfadKuyPV/9XWV5Ksv+vywRXTfZSNIn8z+xk/oq1+cbOPepeNvbXVOF6H92fCOAz/KiS3Mcw338R9tXE3Y7QB1L2kbvbvVHW3Kn/k3Vx8k9Oa19eWX6RYE97Q+oCcVU=",
              "padding": 0
            },
            "hashCount": 16
          },
          "keys": [
            "collection/doc0",
            "collection/doc1",
            "collection/doc2",
            "collection/doc3",
            "collection/doc4",
            "collection/doc5",
            "collection/doc6",
            "collection/doc7",
            "collection/doc8",
            "collection/doc9",
            "collection/doc10",
            "collection/doc11",
            "collection/doc12",
            "collection/doc13",
            "collection/doc14",
            "collection/doc15",
            "collection/doc16",
            "collection/doc17",
            "collection/doc18",
            "collection/doc19",
            "collection/doc20",
            "collection/doc21",
            "collection/doc22",
            "collection/doc23",
            "collection/doc24",
            "collection/doc25",
            "collection/doc26",
            "collection/doc27",
            "collection/doc28",
            "collection/doc29",
            "collection/doc30",
            "collection/doc31",
            "collection/doc32",
            "collection/doc33",
            "collection/doc34",
            "collection/doc35",
            "collection/doc36",
            "collection/doc37",
            "collection/doc38",
            "collection/doc39",
            "collection/doc40",
            "collection/doc41",
            "collection/doc42",
            "collection/doc43",
            "collection/doc44",
            "collection/doc45",
            "collection/doc46",
            "collection/doc47",
            "collection/doc48",
            "collection/doc49"
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeLimboDocs": [
            "collection/doc50",
            "collection/doc51",
            "collection/doc52",
            "collection/doc53",
            "collection/doc54",
            "collection/doc55",
            "collection/doc56",
            "collection/doc57",
            "collection/doc58",
            "collection/doc59",
            "collection/doc60",
            "collection/doc61",
            "collection/doc62",
            "collection/doc63",
            "collection/doc64",
            "collection/doc65",
            "collection/doc66",
            "collection/doc67",
            "collection/doc68",
            "collection/doc69",
            "collection/doc70",
            "collection/doc71",
            "collection/doc72",
            "collection/doc73",
            "collection/doc74",
            "collection/doc75",
            "collection/doc76",
            "collection/doc77",
            "collection/doc78",
            "collection/doc79",
            "collection/doc80",
            "collection/doc81",
            "collection/doc82",
            "collection/doc83",
            "collection/doc84",
            "collection/doc85",
            "collection/doc86",
            "collection/doc87",
            "collection/doc88",
            "collection/doc89",
            "collection/doc90",
            "collection/doc91",
            "collection/doc92",
            "collection/doc93",
            "collection/doc94",
            "collection/doc95",
            "collection/doc96",
            "collection/doc97",
            "collection/doc98",
            "collection/doc99"
          ],
          "activeTargets": {
            "1": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc50"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc50"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "11": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc55"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc55"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "13": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc56"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc56"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "15": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc57"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc57"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "17": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc58"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc58"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "19": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc59"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc59"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            },
            "21": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc60"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc60"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "23": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc61"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc61"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "25": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc62"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc62"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "27": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc63"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc63"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "29": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc64"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc64"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "3": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc51"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc51"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "31": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc65"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc65"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "33": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc66"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc66"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "35": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc67"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc67"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "37": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc68"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc68"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "39": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc69"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc69"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "41": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc70"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc70"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "43": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc71"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc71"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "45": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc72"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc72"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "47": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc73"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc73"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "49": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc74"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc74"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "5": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc52"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc52"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "51": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc75"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc75"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "53": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc76"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc76"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "55": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc77"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc77"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "57": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc78"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc78"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "59": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc79"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc79"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "61": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc80"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc80"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "63": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc81"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc81"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "65": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc82"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc82"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "67": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc83"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc83"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "69": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc84"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc84"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "7": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc53"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc53"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "71": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc85"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc85"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "73": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc86"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc86"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "75": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc87"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc87"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "77": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc88"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc88"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "79": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc89"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc89"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "81": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc90"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc90"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "83": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc91"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc91"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "85": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc92"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc92"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "87": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc93"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc93"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "89": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc94"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc94"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "9": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc54"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc54"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "91": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc95"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc95"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "93": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc96"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc96"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "95": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc97"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc97"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "97": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc98"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc98"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "99": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/doc99"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/doc99"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            }
          }
        }
      }
    ]
  },
  "Existence filter clears resume token": {
    "describeName": "Existence Filters:",
    "itName": "Existence filter clears resume token",
    "tags": [
      "durable-persistence"
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/1",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/2",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 2
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/1",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/2",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 2
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "watchFilter": {
          "keys": [
            "collection/1"
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeExistenceFilterMismatch"
            }
          }
        }
      },
      {
        "restart": true,
        "expectedState": {
          "activeLimboDocs": [
          ],
          "activeTargets": {
          },
          "enqueuedLimboDocs": [
          ]
        }
      },
      {
        "userListen": {
          "query": {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/1",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/2",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 2
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      }
    ]
  },
  "Existence filter handled at global snapshot": {
    "describeName": "Existence Filters:",
    "itName": "Existence filter handled at global snapshot",
    "tags": [
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/1",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/1",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "watchFilter": {
          "keys": [
            "collection/1",
            "collection/2"
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/3",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 3
              },
              "version": 3000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/3",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 3
                },
                "version": 3000
              }
            ],
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeExistenceFilterMismatch"
            }
          }
        }
      },
      {
        "watchRemove": {
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/1",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/2",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 2
              },
              "version": 2000
            },
            {
              "createTime": 0,
              "key": "collection/3",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 3
              },
              "version": 3000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-3000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 3000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/2",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 2
                },
                "version": 2000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      }
    ]
  },
  "Existence filter ignored with pending target": {
    "describeName": "Existence Filters:",
    "itName": "Existence filter ignored with pending target",
    "tags": [
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": false
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/1",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 2
              },
              "version": 2000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/1",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 2
                },
                "version": 2000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "userUnlisten": [
          2,
          {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection"
          }
        ],
        "expectedState": {
          "activeTargets": {
          }
        }
      },
      {
        "userListen": {
          "query": {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/1",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 2
                },
                "version": 2000
              }
            ],
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "resume-token-1000"
            }
          }
        }
      },
      {
        "watchFilter": {
          "keys": [
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchRemove": {
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-2000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      }
    ]
  },
  "Existence filter limbo resolution is denied": {
    "describeName": "Existence Filters:",
    "itName": "Existence filter limbo resolution is denied",
    "tags": [
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/1",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/2",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 2
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/1",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/2",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 2
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "watchFilter": {
          "keys": [
            "collection/1"
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeExistenceFilterMismatch"
            }
          }
        }
      },
      {
        "watchRemove": {
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/1",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-2000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedState": {
          "activeLimboDocs": [
            "collection/2"
          ],
          "activeTargets": {
            "1": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/2"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/2"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeExistenceFilterMismatch"
            }
          }
        }
      },
      {
        "watchRemove": {
          "cause": {
            "code": 7
          },
          "targetIds": [
            1
          ]
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            },
            "removed": [
              {
                "createTime": 0,
                "key": "collection/2",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 2
                },
                "version": 1000
              }
            ]
          }
        ],
        "expectedState": {
          "activeLimboDocs": [
          ],
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeExistenceFilterMismatch"
            }
          }
        }
      }
    ]
  },
  "Existence filter match": {
    "describeName": "Existence Filters:",
    "itName": "Existence filter match",
    "tags": [
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/1",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/1",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "watchFilter": {
          "keys": [
            "collection/1"
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        }
      }
    ]
  },
  "Existence filter match after pending update": {
    "describeName": "Existence Filters:",
    "itName": "Existence filter match after pending update",
    "tags": [
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/1",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 2
              },
              "version": 2000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchFilter": {
          "keys": [
            "collection/1"
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/1",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 2
                },
                "version": 2000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      }
    ]
  },
  "Existence filter mismatch triggers re-run of query": {
    "describeName": "Existence Filters:",
    "itName": "Existence filter mismatch triggers re-run of query",
    "tags": [
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/1",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/2",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 2
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/1",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/2",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 2
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "watchFilter": {
          "keys": [
            "collection/1"
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeExistenceFilterMismatch"
            }
          }
        }
      },
      {
        "watchRemove": {
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/1",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-2000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedState": {
          "activeLimboDocs": [
            "collection/2"
          ],
          "activeTargets": {
            "1": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/2"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/2"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeExistenceFilterMismatch"
            }
          }
        }
      },
      {
        "watchAck": [
          1
        ]
      },
      {
        "watchCurrent": [
          [
            1
          ],
          "resume-token-2000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            },
            "removed": [
              {
                "createTime": 0,
                "key": "collection/2",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 2
                },
                "version": 1000
              }
            ]
          }
        ],
        "expectedState": {
          "activeLimboDocs": [
          ],
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeExistenceFilterMismatch"
            }
          }
        }
      }
    ]
  },
  "Existence filter mismatch will drop resume token": {
    "describeName": "Existence Filters:",
    "itName": "Existence filter mismatch will drop resume token",
    "tags": [
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/1",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/2",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 2
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "existence-filter-resume-token"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/1",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/2",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 2
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "watchStreamClose": {
          "error": {
            "code": 14,
            "message": "Simulated Backend Error"
          },
          "runBackoffTimer": true
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "existence-filter-resume-token"
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchFilter": {
          "keys": [
            "collection/1"
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeExistenceFilterMismatch"
            }
          }
        }
      },
      {
        "watchRemove": {
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/1",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-2000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedState": {
          "activeLimboDocs": [
            "collection/2"
          ],
          "activeTargets": {
            "1": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/2"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/2"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeExistenceFilterMismatch"
            }
          }
        }
      },
      {
        "watchAck": [
          1
        ]
      },
      {
        "watchCurrent": [
          [
            1
          ],
          "resume-token-2000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            },
            "removed": [
              {
                "createTime": 0,
                "key": "collection/2",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 2
                },
                "version": 1000
              }
            ]
          }
        ],
        "expectedState": {
          "activeLimboDocs": [
          ],
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeExistenceFilterMismatch"
            }
          }
        }
      }
    ]
  },
  "Existence filter synthesizes deletes": {
    "describeName": "Existence Filters:",
    "itName": "Existence filter synthesizes deletes",
    "tags": [
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection/a"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/a"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/a"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/a",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/a",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "docPaths": [
                    "/collection/a"
                  ],
                  "name": "documents"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection/a"
            }
          }
        ]
      },
      {
        "watchFilter": {
          "keys": [
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "docPaths": [
                    "/collection/a"
                  ],
                  "name": "documents"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection/a"
            },
            "removed": [
              {
                "createTime": 0,
                "key": "collection/a",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              }
            ]
          }
        ]
      }
    ]
  },
  "Existence filter with empty target": {
    "describeName": "Existence Filters:",
    "itName": "Existence filter with empty target",
    "tags": [
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "watchFilter": {
          "keys": [
            "collection/1"
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeExistenceFilterMismatch"
            }
          }
        }
      }
    ]
  },
  "Full re-query is skipped when bloom filter can identify documents deleted": {
    "describeName": "Existence Filters:",
    "itName": "Full re-query is skipped when bloom filter can identify documents deleted",
    "tags": [
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/a",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/b",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 2
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/a",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/b",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 2
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "watchFilter": {
          "bloomFilter": {
            "bits": {
              "bitmap": "AhAAApAAAIAEBIAABA==",
              "padding": 4
            },
            "hashCount": 10
          },
          "keys": [
            "collection/a"
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeLimboDocs": [
            "collection/b"
          ],
          "activeTargets": {
            "1": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/b"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/b"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          1
        ]
      },
      {
        "watchCurrent": [
          [
            1
          ],
          "resume-token-2000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            },
            "removed": [
              {
                "createTime": 0,
                "key": "collection/b",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 2
                },
                "version": 1000
              }
            ]
          }
        ],
        "expectedState": {
          "activeLimboDocs": [
          ],
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      }
    ]
  },
  "Full re-query is triggered when bloom filter bitmap is invalid": {
    "describeName": "Existence Filters:",
    "itName": "Full re-query is triggered when bloom filter bitmap is invalid",
    "tags": [
      "no-ios",
      "no-android"
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/a",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/b",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/a",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/b",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "watchFilter": {
          "bloomFilter": {
            "bits": {
              "bitmap": "INVALID_BASE_64",
              "padding": 4
            },
            "hashCount": 10
          },
          "keys": [
            "collection/a"
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeExistenceFilterMismatch"
            }
          }
        }
      }
    ]
  },
  "Full re-query is triggered when bloom filter cannot identify documents deleted": {
    "describeName": "Existence Filters:",
    "itName": "Full re-query is triggered when bloom filter cannot identify documents deleted",
    "tags": [
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/a",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/b",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 2
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/c",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 2
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/a",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/b",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 2
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/c",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 2
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "watchFilter": {
          "bloomFilter": {
            "bits": {
              "bitmap": "AxBIApBIAIAWBoCQBA==",
              "padding": 4
            },
            "hashCount": 10
          },
          "keys": [
            "collection/a"
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeExistenceFilterMismatchBloom"
            }
          }
        }
      }
    ]
  },
  "Full re-query is triggered when bloom filter hashCount is invalid": {
    "describeName": "Existence Filters:",
    "itName": "Full re-query is triggered when bloom filter hashCount is invalid",
    "tags": [
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/a",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/b",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/a",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/b",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "watchFilter": {
          "bloomFilter": {
            "bits": {
              "bitmap": "AhAAApAAAIAEBIAABA==",
              "padding": 4
            },
            "hashCount": -1
          },
          "keys": [
            "collection/a"
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeExistenceFilterMismatch"
            }
          }
        }
      }
    ]
  },
  "Full re-query is triggered when bloom filter is empty": {
    "describeName": "Existence Filters:",
    "itName": "Full re-query is triggered when bloom filter is empty",
    "tags": [
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/a",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/b",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/a",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/b",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "watchFilter": {
          "bloomFilter": {
            "bits": {
              "bitmap": "",
              "padding": 0
            },
            "hashCount": 0
          },
          "keys": [
            "collection/a"
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeExistenceFilterMismatch"
            }
          }
        }
      }
    ]
  },
  "Resume a query with bloom filter when documents are added, removed and deleted": {
    "describeName": "Existence Filters:",
    "itName": "Resume a query with bloom filter when documents are added, removed and deleted",
    "tags": [
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
              [
                "v",
                "==",
                1
              ]
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "eq",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              },
                              {
                                "_createdFromLiteral": false,
                                "_protoValue": {
                                  "integerValue": "1"
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Constant",
                                "value": {
                                  "integerValue": "1"
                                }
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                    [
                      "v",
                      "==",
                      1
                    ]
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/a",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/b",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/c",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/a",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/b",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/c",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "and",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "eq",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValue": {
                              "integerValue": "1"
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Constant",
                            "value": {
                              "integerValue": "1"
                            }
                          }
                        ]
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
                [
                  "v",
                  "==",
                  1
                ]
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "enableNetwork": false,
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "and",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "eq",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValue": {
                              "integerValue": "1"
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Constant",
                            "value": {
                              "integerValue": "1"
                            }
                          }
                        ]
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
                [
                  "v",
                  "==",
                  1
                ]
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeLimboDocs": [
          ],
          "activeTargets": {
          },
          "enqueuedLimboDocs": [
          ]
        }
      },
      {
        "enableNetwork": true,
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "eq",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              },
                              {
                                "_createdFromLiteral": false,
                                "_protoValue": {
                                  "integerValue": "1"
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Constant",
                                "value": {
                                  "integerValue": "1"
                                }
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                },
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "eq",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              },
                              {
                                "_createdFromLiteral": false,
                                "_protoValue": {
                                  "integerValue": "1"
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Constant",
                                "value": {
                                  "integerValue": "1"
                                }
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                    [
                      "v",
                      "==",
                      1
                    ]
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "resume-token-1000"
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/d",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchFilter": {
          "bloomFilter": {
            "bits": {
              "bitmap": "AhICApAQEICEhIAEBA==",
              "padding": 4
            },
            "hashCount": 10
          },
          "keys": [
            "collection/a",
            "collection/d"
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-2000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/d",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "and",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "eq",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValue": {
                              "integerValue": "1"
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Constant",
                            "value": {
                              "integerValue": "1"
                            }
                          }
                        ]
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
                [
                  "v",
                  "==",
                  1
                ]
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeLimboDocs": [
            "collection/b",
            "collection/c"
          ],
          "activeTargets": {
            "1": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/b"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/b"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "eq",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              },
                              {
                                "_createdFromLiteral": false,
                                "_protoValue": {
                                  "integerValue": "1"
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Constant",
                                "value": {
                                  "integerValue": "1"
                                }
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                },
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "eq",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              },
                              {
                                "_createdFromLiteral": false,
                                "_protoValue": {
                                  "integerValue": "1"
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Constant",
                                "value": {
                                  "integerValue": "1"
                                }
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                    [
                      "v",
                      "==",
                      1
                    ]
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "resume-token-1000"
            },
            "3": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/c"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/c"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            }
          }
        }
      }
    ]
  },
  "Resume a query with bloom filter when documents are updated to no longer match the query": {
    "describeName": "Existence Filters:",
    "itName": "Resume a query with bloom filter when documents are updated to no longer match the query",
    "tags": [
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
              [
                "v",
                "==",
                1
              ]
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "eq",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              },
                              {
                                "_createdFromLiteral": false,
                                "_protoValue": {
                                  "integerValue": "1"
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Constant",
                                "value": {
                                  "integerValue": "1"
                                }
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                    [
                      "v",
                      "==",
                      1
                    ]
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/a",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/b",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/a",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/b",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "and",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "eq",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValue": {
                              "integerValue": "1"
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Constant",
                            "value": {
                              "integerValue": "1"
                            }
                          }
                        ]
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
                [
                  "v",
                  "==",
                  1
                ]
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "enableNetwork": false,
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "and",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "eq",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValue": {
                              "integerValue": "1"
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Constant",
                            "value": {
                              "integerValue": "1"
                            }
                          }
                        ]
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
                [
                  "v",
                  "==",
                  1
                ]
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeLimboDocs": [
          ],
          "activeTargets": {
          },
          "enqueuedLimboDocs": [
          ]
        }
      },
      {
        "enableNetwork": true,
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "eq",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              },
                              {
                                "_createdFromLiteral": false,
                                "_protoValue": {
                                  "integerValue": "1"
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Constant",
                                "value": {
                                  "integerValue": "1"
                                }
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                },
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "eq",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              },
                              {
                                "_createdFromLiteral": false,
                                "_protoValue": {
                                  "integerValue": "1"
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Constant",
                                "value": {
                                  "integerValue": "1"
                                }
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                    [
                      "v",
                      "==",
                      1
                    ]
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "resume-token-1000"
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchFilter": {
          "bloomFilter": {
            "bits": {
              "bitmap": "AhAAApAAAIAEBIAABA==",
              "padding": 4
            },
            "hashCount": 10
          },
          "keys": [
            "collection/a"
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-2000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedState": {
          "activeLimboDocs": [
            "collection/b"
          ],
          "activeTargets": {
            "1": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/b"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/b"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "eq",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              },
                              {
                                "_createdFromLiteral": false,
                                "_protoValue": {
                                  "integerValue": "1"
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Constant",
                                "value": {
                                  "integerValue": "1"
                                }
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                },
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "eq",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              },
                              {
                                "_createdFromLiteral": false,
                                "_protoValue": {
                                  "integerValue": "1"
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Constant",
                                "value": {
                                  "integerValue": "1"
                                }
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                    [
                      "v",
                      "==",
                      1
                    ]
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "resume-token-1000"
            }
          }
        }
      }
    ]
  },
  "Resume a query with bloom filter when existing docs are updated": {
    "describeName": "Existence Filters:",
    "itName": "Resume a query with bloom filter when existing docs are updated",
    "tags": [
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
              [
                "v",
                ">=",
                1
              ]
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "gte",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              },
                              {
                                "_createdFromLiteral": false,
                                "_protoValue": {
                                  "integerValue": "1"
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Constant",
                                "value": {
                                  "integerValue": "1"
                                }
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "__name__"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        },
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                    [
                      "v",
                      ">=",
                      1
                    ]
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/a",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/b",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/a",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/b",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "and",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "gte",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValue": {
                              "integerValue": "1"
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Constant",
                            "value": {
                              "integerValue": "1"
                            }
                          }
                        ]
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "and",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "v"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    },
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
                [
                  "v",
                  ">=",
                  1
                ]
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "enableNetwork": false,
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "and",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "gte",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValue": {
                              "integerValue": "1"
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Constant",
                            "value": {
                              "integerValue": "1"
                            }
                          }
                        ]
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "and",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "v"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    },
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
                [
                  "v",
                  ">=",
                  1
                ]
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeLimboDocs": [
          ],
          "activeTargets": {
          },
          "enqueuedLimboDocs": [
          ]
        }
      },
      {
        "enableNetwork": true,
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "gte",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              },
                              {
                                "_createdFromLiteral": false,
                                "_protoValue": {
                                  "integerValue": "1"
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Constant",
                                "value": {
                                  "integerValue": "1"
                                }
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "__name__"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        },
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                },
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "gte",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              },
                              {
                                "_createdFromLiteral": false,
                                "_protoValue": {
                                  "integerValue": "1"
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Constant",
                                "value": {
                                  "integerValue": "1"
                                }
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "__name__"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        },
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                    [
                      "v",
                      ">=",
                      1
                    ]
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "resume-token-1000"
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/b",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 2
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchFilter": {
          "bloomFilter": {
            "bits": {
              "bitmap": "AxBIApBIAIAWBoCQBA==",
              "padding": 4
            },
            "hashCount": 10
          },
          "keys": [
            "collection/a",
            "collection/b"
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-2000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "and",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "gte",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValue": {
                              "integerValue": "1"
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Constant",
                            "value": {
                              "integerValue": "1"
                            }
                          }
                        ]
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "and",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "v"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    },
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
                [
                  "v",
                  ">=",
                  1
                ]
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      }
    ]
  },
  "Resume a query with bloom filter when new documents are added": {
    "describeName": "Existence Filters:",
    "itName": "Resume a query with bloom filter when new documents are added",
    "tags": [
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/a",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/a",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "enableNetwork": false,
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeLimboDocs": [
          ],
          "activeTargets": {
          },
          "enqueuedLimboDocs": [
          ]
        }
      },
      {
        "enableNetwork": true,
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                },
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "resume-token-1000"
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/b",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 2
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchFilter": {
          "bloomFilter": {
            "bits": {
              "bitmap": "AxBIApBIAIAWBoCQBA==",
              "padding": 4
            },
            "hashCount": 10
          },
          "keys": [
            "collection/a",
            "collection/b"
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-2000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/b",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 2
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      }
    ]
  },
  "Resume a query with bloom filter when there is no document changes": {
    "describeName": "Existence Filters:",
    "itName": "Resume a query with bloom filter when there is no document changes",
    "tags": [
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/a",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/a",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "enableNetwork": false,
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeLimboDocs": [
          ],
          "activeTargets": {
          },
          "enqueuedLimboDocs": [
          ]
        }
      },
      {
        "enableNetwork": true,
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                },
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": "resume-token-1000"
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchFilter": {
          "bloomFilter": {
            "bits": {
              "bitmap": "AhAAApAAAIAEBIAABA==",
              "padding": 4
            },
            "hashCount": 10
          },
          "keys": [
            "collection/a"
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-2000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "exists",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      }
    ]
  },
  "Same documents can have different bloom filters": {
    "describeName": "Existence Filters:",
    "itName": "Same documents can have different bloom filters",
    "tags": [
    ],
    "config": {
      "numClients": 1,
      "useEagerGCForMemory": true
    },
    "steps": [
      {
        "userListen": {
          "query": {
            "filters": [
              [
                "v",
                "<=",
                2
              ]
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 2
        },
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "lte",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              },
                              {
                                "_createdFromLiteral": false,
                                "_protoValue": {
                                  "integerValue": "2"
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Constant",
                                "value": {
                                  "integerValue": "2"
                                }
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "__name__"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        },
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                    [
                      "v",
                      "<=",
                      2
                    ]
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          2
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/a",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 1
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/b",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 2
              },
              "version": 1000
            }
          ],
          "targets": [
            2
          ]
        }
      },
      {
        "watchCurrent": [
          [
            2
          ],
          "resume-token-1000"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1000
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/a",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 1
                },
                "version": 1000
              },
              {
                "createTime": 0,
                "key": "collection/b",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 2
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "and",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "lte",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValue": {
                              "integerValue": "2"
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Constant",
                            "value": {
                              "integerValue": "2"
                            }
                          }
                        ]
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "and",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "v"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    },
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
                [
                  "v",
                  "<=",
                  2
                ]
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "userListen": {
          "query": {
            "filters": [
              [
                "v",
                ">=",
                2
              ]
            ],
            "orderBys": [
            ],
            "path": "collection"
          },
          "targetId": 4
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/b",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 2
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "and",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "gte",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValue": {
                              "integerValue": "2"
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Constant",
                            "value": {
                              "integerValue": "2"
                            }
                          }
                        ]
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "and",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "v"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    },
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
                [
                  "v",
                  ">=",
                  2
                ]
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeTargets": {
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "lte",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              },
                              {
                                "_createdFromLiteral": false,
                                "_protoValue": {
                                  "integerValue": "2"
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Constant",
                                "value": {
                                  "integerValue": "2"
                                }
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "__name__"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        },
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                    [
                      "v",
                      "<=",
                      2
                    ]
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            },
            "4": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "gte",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              },
                              {
                                "_createdFromLiteral": false,
                                "_protoValue": {
                                  "integerValue": "2"
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Constant",
                                "value": {
                                  "integerValue": "2"
                                }
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "__name__"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        },
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                    [
                      "v",
                      ">=",
                      2
                    ]
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchAck": [
          4
        ]
      },
      {
        "watchEntity": {
          "docs": [
            {
              "createTime": 0,
              "key": "collection/b",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 2
              },
              "version": 1000
            },
            {
              "createTime": 0,
              "key": "collection/c",
              "options": {
                "hasCommittedMutations": false,
                "hasLocalMutations": false
              },
              "value": {
                "v": 3
              },
              "version": 1000
            }
          ],
          "targets": [
            4
          ]
        }
      },
      {
        "watchCurrent": [
          [
            4
          ],
          "resume-token-1001"
        ]
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 1001
        },
        "expectedSnapshotEvents": [
          {
            "added": [
              {
                "createTime": 0,
                "key": "collection/c",
                "options": {
                  "hasCommittedMutations": false,
                  "hasLocalMutations": false
                },
                "value": {
                  "v": 3
                },
                "version": 1000
              }
            ],
            "errorCode": 0,
            "fromCache": false,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "and",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "gte",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValue": {
                              "integerValue": "2"
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Constant",
                            "value": {
                              "integerValue": "2"
                            }
                          }
                        ]
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "and",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "v"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    },
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
                [
                  "v",
                  ">=",
                  2
                ]
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ]
      },
      {
        "watchFilter": {
          "bloomFilter": {
            "bits": {
              "bitmap": "CQ==",
              "padding": 3
            },
            "hashCount": 2
          },
          "keys": [
            "collection/b"
          ],
          "targetIds": [
            2
          ]
        }
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 2000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "and",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "lte",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValue": {
                              "integerValue": "2"
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Constant",
                            "value": {
                              "integerValue": "2"
                            }
                          }
                        ]
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "and",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "v"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    },
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
                [
                  "v",
                  "<=",
                  2
                ]
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeLimboDocs": [
            "collection/a"
          ],
          "activeTargets": {
            "1": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/a"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/a"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "lte",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              },
                              {
                                "_createdFromLiteral": false,
                                "_protoValue": {
                                  "integerValue": "2"
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Constant",
                                "value": {
                                  "integerValue": "2"
                                }
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "__name__"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        },
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                    [
                      "v",
                      "<=",
                      2
                    ]
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            },
            "4": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "gte",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              },
                              {
                                "_createdFromLiteral": false,
                                "_protoValue": {
                                  "integerValue": "2"
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Constant",
                                "value": {
                                  "integerValue": "2"
                                }
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "__name__"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        },
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                    [
                      "v",
                      ">=",
                      2
                    ]
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      },
      {
        "watchFilter": {
          "bloomFilter": {
            "bits": {
              "bitmap": "CA==",
              "padding": 4
            },
            "hashCount": 1
          },
          "keys": [
            "collection/b"
          ],
          "targetIds": [
            4
          ]
        }
      },
      {
        "watchSnapshot": {
          "targetIds": [
          ],
          "version": 3000
        },
        "expectedSnapshotEvents": [
          {
            "errorCode": 0,
            "fromCache": true,
            "hasPendingWrites": false,
            "pipeline": {
              "isCorePipeline": true,
              "serializer": {
                "databaseId": {
                  "database": "(default)",
                  "projectId": "test-project"
                },
                "useProto3Json": false
              },
              "stages": [
                {
                  "collectionPath": "/collection",
                  "name": "collection"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "and",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "gte",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValue": {
                              "integerValue": "2"
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Constant",
                            "value": {
                              "integerValue": "2"
                            }
                          }
                        ]
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "condition": {
                    "_createdFromLiteral": false,
                    "_protoValueType": "ProtoValue",
                    "exprType": "Function",
                    "filterable": true,
                    "name": "and",
                    "params": [
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      }
                    ]
                  },
                  "name": "where"
                },
                {
                  "name": "sort",
                  "orders": [
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "v"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    },
                    {
                      "_createdFromLiteral": false,
                      "_protoValueType": "ProtoValue",
                      "direction": "ascending",
                      "expr": {
                        "_createdFromLiteral": false,
                        "_fieldPath": {
                          "len": 1,
                          "offset": 0,
                          "segments": [
                            "__name__"
                          ]
                        },
                        "_protoValueType": "ProtoValue",
                        "exprType": "Field",
                        "pipeline": null,
                        "selectable": true
                      }
                    }
                  ]
                }
              ]
            },
            "query": {
              "filters": [
                [
                  "v",
                  ">=",
                  2
                ]
              ],
              "orderBys": [
              ],
              "path": "collection"
            }
          }
        ],
        "expectedState": {
          "activeLimboDocs": [
            "collection/a",
            "collection/c"
          ],
          "activeTargets": {
            "1": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/a"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/a"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "2": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "lte",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              },
                              {
                                "_createdFromLiteral": false,
                                "_protoValue": {
                                  "integerValue": "2"
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Constant",
                                "value": {
                                  "integerValue": "2"
                                }
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "__name__"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        },
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                    [
                      "v",
                      "<=",
                      2
                    ]
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            },
            "3": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "docPaths": [
                        "/collection/c"
                      ],
                      "name": "documents"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "exists",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                  ],
                  "orderBys": [
                  ],
                  "path": "collection/c"
                }
              ],
              "resumeToken": "",
              "targetPurpose": "TargetPurposeLimboResolution"
            },
            "4": {
              "pipelines": [
                {
                  "isCorePipeline": true,
                  "serializer": {
                    "databaseId": {
                      "database": "(default)",
                      "projectId": "test-project"
                    },
                    "useProto3Json": false
                  },
                  "stages": [
                    {
                      "collectionPath": "/collection",
                      "name": "collection"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "gte",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              },
                              {
                                "_createdFromLiteral": false,
                                "_protoValue": {
                                  "integerValue": "2"
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Constant",
                                "value": {
                                  "integerValue": "2"
                                }
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "condition": {
                        "_createdFromLiteral": false,
                        "_protoValueType": "ProtoValue",
                        "exprType": "Function",
                        "filterable": true,
                        "name": "and",
                        "params": [
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "v"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          },
                          {
                            "_createdFromLiteral": false,
                            "_protoValueType": "ProtoValue",
                            "exprType": "Function",
                            "filterable": true,
                            "name": "exists",
                            "params": [
                              {
                                "_createdFromLiteral": false,
                                "_fieldPath": {
                                  "len": 1,
                                  "offset": 0,
                                  "segments": [
                                    "__name__"
                                  ]
                                },
                                "_protoValueType": "ProtoValue",
                                "exprType": "Field",
                                "pipeline": null,
                                "selectable": true
                              }
                            ]
                          }
                        ]
                      },
                      "name": "where"
                    },
                    {
                      "name": "sort",
                      "orders": [
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "v"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        },
                        {
                          "_createdFromLiteral": false,
                          "_protoValueType": "ProtoValue",
                          "direction": "ascending",
                          "expr": {
                            "_createdFromLiteral": false,
                            "_fieldPath": {
                              "len": 1,
                              "offset": 0,
                              "segments": [
                                "__name__"
                              ]
                            },
                            "_protoValueType": "ProtoValue",
                            "exprType": "Field",
                            "pipeline": null,
                            "selectable": true
                          }
                        }
                      ]
                    }
                  ]
                }
              ],
              "queries": [
                {
                  "filters": [
                    [
                      "v",
                      ">=",
                      2
                    ]
                  ],
                  "orderBys": [
                  ],
                  "path": "collection"
                }
              ],
              "resumeToken": ""
            }
          }
        }
      }
    ]
  }
}
